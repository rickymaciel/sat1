/*
 * UINuevaCP.java
 *
 * Created on 9 de enero de 2008, 9:08
 */

package vista;

import Datos.Consulta;
import controlador.CAlta;
import controlador.CListar;
import controlador.CUltimo;
import java.awt.Dimension;
import java.awt.Toolkit;
import java.text.DateFormat;
import java.text.NumberFormat;
import java.text.ParseException;
import java.util.ArrayList;
//import java.util.Calendar;
import java.util.Collection;
import java.util.Date;
import java.util.Enumeration;
import java.util.Iterator;
import java.util.Vector;
import javax.swing.DefaultCellEditor;
import javax.swing.JComboBox;
import javax.swing.JOptionPane;
import javax.swing.table.DefaultTableModel;
//import javax.swing.table.TableCellEditor;
import javax.swing.table.TableColumn;
import negocios.Barrio;
import negocios.Departamento;
import negocios.DetalleCP;
import negocios.Documento;
import negocios.EncabezadoCP;
import negocios.Localidad;
import negocios.Matriculado;
import negocios.MostrarTotales;
import negocios.Provincia;
import negocios.SerieConstancia;
import negocios.Tasa;
import negocios.TasaAplicable;
import negocios.TipoSeccion;
import negocios.TipoSuperficie;
import negocios.TipoTrabajo;
import negocios.Usuario;
import reportes.cExport_thread;

/**
 *
 * @author  Administrador
 */
public class UINuevaCP extends javax.swing.JFrame
{
    //Encabezado
    private Usuario usuario=new Usuario();
    private Collection series = new ArrayList();    
    private Matriculado matriculado = new Matriculado();
    private Boolean solicitanteCargado=false;
    //Ubicacion de la Obra
    private Provincia provincia= new Provincia();
    private Departamento departamento= new Departamento();
    private Localidad localidad= new Localidad();
    private Barrio barrio= new Barrio();
    //Detalle
    private Collection tiposTrabajos=new ArrayList();
    private Collection tiposSuperficies=new ArrayList();
    private Collection tiposSecciones=new ArrayList();
    //Pie
    private Double total=0.0;
    // tasas aplicables a esta constancia
    private Collection tasasAplicables = new ArrayList();
    private Collection mostrarTotales = new ArrayList();
    
    private int vector[] = new int[10];
    private TasaAplicable vectorTrabajo[] = new TasaAplicable[10];
    private Documento documento = new Documento();
    private Collection tasas = new ArrayList();
    private int tamanioVector;
    private boolean automatico = true;
    private long nroConst;
    
    
    /** Creates new form UINuevaCP */
    public UINuevaCP()
    {
        initComponents();
        // Codigo necesario para centrar la ventana
        Dimension pantalla, cuadro;
        pantalla = Toolkit.getDefaultToolkit().getScreenSize();
        cuadro = this.getSize();
        this.setLocation(((pantalla.width - cuadro.width)/2), (pantalla.height - cuadro.height)/2);
        this.inicializarFormulario();
        //Fin del centrado
    }
    public UINuevaCP(Usuario user)
    {
        initComponents();
        this.usuario=user;
        // Codigo necesario para centrar la ventana
        Dimension pantalla, cuadro;
        pantalla = Toolkit.getDefaultToolkit().getScreenSize();
        cuadro = this.getSize();
        this.setLocation(((pantalla.width - cuadro.width)/2), (pantalla.height - cuadro.height)/2);
        this.inicializarFormulario();
        //Fin del centrado
    }
    public UINuevaCP(String algo)
    {
    }
    
    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        jPanel2 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        jTNumeroConstancia = new javax.swing.JTextField();
        jLabel3 = new javax.swing.JLabel();
        jCSerie = new javax.swing.JComboBox();
        jTFecha = new javax.swing.JTextField();
        jPanel3 = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        jTableParticipantes = new javax.swing.JTable();
        jLabel4 = new javax.swing.JLabel();
        jTNombrePropietario = new javax.swing.JTextField();
        jLabel5 = new javax.swing.JLabel();
        jTNombreComitente = new javax.swing.JTextField();
        jBQuitarMatriculado = new javax.swing.JButton();
        jTMatricula = new javax.swing.JTextField();
        jLabel18 = new javax.swing.JLabel();
        jTNumeroFactura = new javax.swing.JTextField();
        jLabel19 = new javax.swing.JLabel();
        jLabel20 = new javax.swing.JLabel();
        jTSerieFactura = new javax.swing.JTextField();
        jPanel4 = new javax.swing.JPanel();
        jScrollPane2 = new javax.swing.JScrollPane();
        jTableTrabajos = new javax.swing.JTable();
        jPanel5 = new javax.swing.JPanel();
        jLabel7 = new javax.swing.JLabel();
        jLabel8 = new javax.swing.JLabel();
        jLabel9 = new javax.swing.JLabel();
        jTCalle = new javax.swing.JTextField();
        jLabel10 = new javax.swing.JLabel();
        jLabel11 = new javax.swing.JLabel();
        jLabel12 = new javax.swing.JLabel();
        jTNumero = new javax.swing.JTextField();
        jTManzana = new javax.swing.JTextField();
        jTLote = new javax.swing.JTextField();
        jLabel13 = new javax.swing.JLabel();
        jLabel14 = new javax.swing.JLabel();
        jTProvincia = new javax.swing.JTextField();
        jTDepartamento = new javax.swing.JTextField();
        jTLocalidad = new javax.swing.JTextField();
        jTBarrio = new javax.swing.JTextField();
        jBUbicacion = new javax.swing.JButton();
        jPanel6 = new javax.swing.JPanel();
        jScrollPane3 = new javax.swing.JScrollPane();
        jTableDetalle = new javax.swing.JTable();
        jLabel6 = new javax.swing.JLabel();
        jTSuperficieRelevada = new javax.swing.JTextField();
        jLabel15 = new javax.swing.JLabel();
        jTSuperficieProyecto = new javax.swing.JTextField();
        jLabel16 = new javax.swing.JLabel();
        jTCambioTecho = new javax.swing.JTextField();
        jLabel17 = new javax.swing.JLabel();
        jTOrdenTrabajo = new javax.swing.JTextField();
        jBQuitarDetalle = new javax.swing.JButton();
        jBMostrarTotales = new javax.swing.JButton();
        jTTotal = new javax.swing.JTextField();
        jLabel21 = new javax.swing.JLabel();
        jBGuardar = new javax.swing.JButton();
        jBSalir = new javax.swing.JButton();
        jBImprimir = new javax.swing.JButton();
        jBNueva = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        setTitle("Nueva Constancia Parcial");
        setResizable(false);

        jPanel1.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        jPanel2.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        jLabel1.setBackground(new java.awt.Color(255, 255, 204));
        jLabel1.setText("Fecha");
        jLabel1.setBorder(javax.swing.BorderFactory.createEtchedBorder(new java.awt.Color(255, 255, 102), null));
        jLabel1.setOpaque(true);

        jLabel2.setBackground(new java.awt.Color(255, 255, 204));
        jLabel2.setText("Serie");
        jLabel2.setBorder(javax.swing.BorderFactory.createEtchedBorder(new java.awt.Color(255, 255, 102), null));
        jLabel2.setOpaque(true);

        jTNumeroConstancia.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jTNumeroConstanciaKeyPressed(evt);
            }
        });

        jLabel3.setBackground(new java.awt.Color(255, 255, 204));
        jLabel3.setText("Nro. Constancia");
        jLabel3.setBorder(javax.swing.BorderFactory.createEtchedBorder(new java.awt.Color(255, 255, 102), null));
        jLabel3.setOpaque(true);

        jCSerie.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jCSerieActionPerformed(evt);
            }
        });
        jCSerie.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jCSerieKeyPressed(evt);
            }
        });

        jTFecha.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jTFechaKeyPressed(evt);
            }
        });

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 51, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(jTFecha, javax.swing.GroupLayout.PREFERRED_SIZE, 123, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(jLabel2, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jCSerie, javax.swing.GroupLayout.PREFERRED_SIZE, 59, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(jLabel3, javax.swing.GroupLayout.PREFERRED_SIZE, 92, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jTNumeroConstancia, javax.swing.GroupLayout.PREFERRED_SIZE, 132, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(38, Short.MAX_VALUE))
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel2, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jCSerie, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jTFecha, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jTNumeroConstancia, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel3, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel3.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Participantes", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 0, 10)));

        jTableParticipantes.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Orden", "Matricula", "Apellido", "Nombre"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        jTableParticipantes.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jTableParticipantesKeyPressed(evt);
            }
        });
        jScrollPane1.setViewportView(jTableParticipantes);

        jLabel4.setBackground(new java.awt.Color(255, 255, 204));
        jLabel4.setText("Propietario");
        jLabel4.setBorder(javax.swing.BorderFactory.createEtchedBorder(new java.awt.Color(255, 255, 102), null));
        jLabel4.setOpaque(true);

        jTNombrePropietario.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jTNombrePropietarioKeyPressed(evt);
            }
        });

        jLabel5.setBackground(new java.awt.Color(255, 255, 204));
        jLabel5.setText("Comitente");
        jLabel5.setBorder(javax.swing.BorderFactory.createEtchedBorder(new java.awt.Color(255, 255, 102), null));
        jLabel5.setOpaque(true);

        jTNombreComitente.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jTNombreComitenteKeyPressed(evt);
            }
        });

        jBQuitarMatriculado.setIcon(new javax.swing.ImageIcon(getClass().getResource("/iconos/remove.gif"))); // NOI18N
        jBQuitarMatriculado.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jBQuitarMatriculadoActionPerformed(evt);
            }
        });

        jTMatricula.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jTMatriculaKeyPressed(evt);
            }
            public void keyReleased(java.awt.event.KeyEvent evt) {
                jTMatriculaKeyReleased(evt);
            }
        });

        jLabel18.setText("Matricula Solic.:");

        jTNumeroFactura.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jTNumeroFacturaKeyPressed(evt);
            }
        });

        jLabel19.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel19.setText("Nro de Factura");

        jLabel20.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel20.setText("Serie Factura");

        jTSerieFactura.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jTSerieFacturaKeyPressed(evt);
            }
        });

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel4, javax.swing.GroupLayout.PREFERRED_SIZE, 75, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel18))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(jTMatricula)
                            .addComponent(jTNombrePropietario, javax.swing.GroupLayout.DEFAULT_SIZE, 219, Short.MAX_VALUE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel3Layout.createSequentialGroup()
                                .addComponent(jLabel5, javax.swing.GroupLayout.PREFERRED_SIZE, 75, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jTNombreComitente))
                            .addGroup(jPanel3Layout.createSequentialGroup()
                                .addGap(2, 2, 2)
                                .addComponent(jBQuitarMatriculado, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(6, 6, 6)
                                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                    .addComponent(jTSerieFactura)
                                    .addComponent(jLabel20, javax.swing.GroupLayout.DEFAULT_SIZE, 78, Short.MAX_VALUE))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                    .addComponent(jLabel19, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                    .addComponent(jTNumeroFactura, javax.swing.GroupLayout.DEFAULT_SIZE, 125, Short.MAX_VALUE)))))
                    .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 580, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(27, Short.MAX_VALUE))
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel4, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jTNombrePropietario, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel5, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jTNombreComitente, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(6, 6, 6)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addGap(11, 11, 11)
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel18)
                            .addComponent(jTMatricula, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jBQuitarMatriculado, javax.swing.GroupLayout.PREFERRED_SIZE, 32, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGroup(jPanel3Layout.createSequentialGroup()
                                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                    .addComponent(jLabel20)
                                    .addComponent(jLabel19))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                    .addComponent(jTSerieFactura, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(jTNumeroFactura, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE))))))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 69, Short.MAX_VALUE))
        );

        jPanel4.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Tipos de trabajo", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 0, 10)));

        jTableTrabajos.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Proyecto", "Conduccion Tecnica", "Calculo H° A°", "Relevamiento", "Cambio Techo"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Boolean.class, java.lang.Boolean.class, java.lang.Boolean.class, java.lang.Boolean.class, java.lang.Boolean.class
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }
        });
        jTableTrabajos.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jTableTrabajosMouseClicked(evt);
            }
            public void mouseReleased(java.awt.event.MouseEvent evt) {
                jTableTrabajosMouseReleased(evt);
            }
        });
        jScrollPane2.setViewportView(jTableTrabajos);

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jScrollPane2, javax.swing.GroupLayout.DEFAULT_SIZE, 607, Short.MAX_VALUE)
        );
        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jScrollPane2, javax.swing.GroupLayout.DEFAULT_SIZE, 79, Short.MAX_VALUE)
        );

        jPanel5.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Ubicacion de la obra", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 0, 10)));

        jLabel7.setText("Provincia");

        jLabel8.setText("Localidad");

        jLabel9.setText("Depto");

        jTCalle.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jTCalleKeyPressed(evt);
            }
        });

        jLabel10.setFont(new java.awt.Font("Tahoma", 0, 10));
        jLabel10.setText("Calle");

        jLabel11.setFont(new java.awt.Font("Tahoma", 0, 10));
        jLabel11.setText("Numero");

        jLabel12.setFont(new java.awt.Font("Tahoma", 0, 10));
        jLabel12.setText("Manzana");

        jTNumero.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jTNumeroKeyPressed(evt);
            }
        });

        jTManzana.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jTManzanaKeyPressed(evt);
            }
        });

        jLabel13.setFont(new java.awt.Font("Tahoma", 0, 10));
        jLabel13.setText("Lote");

        jLabel14.setText("Barrio");

        jTProvincia.setEnabled(false);

        jTDepartamento.setEnabled(false);

        jTLocalidad.setEnabled(false);

        jTBarrio.setEnabled(false);

        jBUbicacion.setText("Ubicacion");
        jBUbicacion.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jBUbicacionActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
        jPanel5.setLayout(jPanel5Layout);
        jPanel5Layout.setHorizontalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel5Layout.createSequentialGroup()
                        .addComponent(jLabel7)
                        .addGap(5, 5, 5)
                        .addComponent(jTProvincia, javax.swing.GroupLayout.DEFAULT_SIZE, 211, Short.MAX_VALUE))
                    .addGroup(jPanel5Layout.createSequentialGroup()
                        .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel8)
                            .addComponent(jLabel10))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jTLocalidad, javax.swing.GroupLayout.DEFAULT_SIZE, 211, Short.MAX_VALUE)
                            .addComponent(jTCalle, javax.swing.GroupLayout.DEFAULT_SIZE, 211, Short.MAX_VALUE))))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel5Layout.createSequentialGroup()
                        .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel14)
                            .addComponent(jLabel11))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel5Layout.createSequentialGroup()
                                .addComponent(jTNumero, javax.swing.GroupLayout.PREFERRED_SIZE, 53, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jLabel12)
                                .addGap(12, 12, 12)
                                .addComponent(jTManzana, javax.swing.GroupLayout.PREFERRED_SIZE, 49, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(jLabel13)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jTLote, javax.swing.GroupLayout.PREFERRED_SIZE, 54, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(jPanel5Layout.createSequentialGroup()
                                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                                    .addComponent(jTBarrio, javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jTDepartamento, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, 180, Short.MAX_VALUE))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jBUbicacion, javax.swing.GroupLayout.PREFERRED_SIZE, 90, javax.swing.GroupLayout.PREFERRED_SIZE))))
                    .addComponent(jLabel9))
                .addGap(22, 22, 22))
        );
        jPanel5Layout.setVerticalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel5Layout.createSequentialGroup()
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel5Layout.createSequentialGroup()
                        .addGap(3, 3, 3)
                        .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel9)
                            .addComponent(jTDepartamento)
                            .addComponent(jBUbicacion)
                            .addComponent(jTProvincia)))
                    .addComponent(jLabel7, javax.swing.GroupLayout.Alignment.TRAILING))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel8)
                    .addComponent(jLabel14)
                    .addComponent(jTLocalidad)
                    .addComponent(jTBarrio))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel10)
                    .addComponent(jTCalle, javax.swing.GroupLayout.DEFAULT_SIZE, 20, Short.MAX_VALUE)
                    .addComponent(jLabel11)
                    .addComponent(jTNumero, javax.swing.GroupLayout.DEFAULT_SIZE, 20, Short.MAX_VALUE)
                    .addComponent(jLabel12)
                    .addComponent(jLabel13)
                    .addComponent(jTLote, javax.swing.GroupLayout.DEFAULT_SIZE, 20, Short.MAX_VALUE)
                    .addComponent(jTManzana, javax.swing.GroupLayout.DEFAULT_SIZE, 20, Short.MAX_VALUE))
                .addGap(37, 37, 37))
        );

        jPanel6.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Detalle", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 0, 10)));

        jTableDetalle.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null}
            },
            new String [] {
                "Trabajo", "Tipo Superficie", "Tipo Seccion", "Superficie"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Double.class
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }
        });
        jTableDetalle.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jTableDetalleKeyPressed(evt);
            }
            public void keyReleased(java.awt.event.KeyEvent evt) {
                jTableDetalleKeyReleased(evt);
            }
        });
        jScrollPane3.setViewportView(jTableDetalle);

        jLabel6.setFont(new java.awt.Font("Tahoma", 0, 10));
        jLabel6.setText("Sup. Relevada");

        jTSuperficieRelevada.setDisabledTextColor(new java.awt.Color(0, 0, 0));

        jLabel15.setFont(new java.awt.Font("Tahoma", 0, 10));
        jLabel15.setText("Sup. Proyecto");

        jTSuperficieProyecto.setDisabledTextColor(new java.awt.Color(0, 0, 0));

        jLabel16.setFont(new java.awt.Font("Tahoma", 0, 10));
        jLabel16.setText("Total");

        jTCambioTecho.setDisabledTextColor(new java.awt.Color(0, 0, 0));

        jLabel17.setFont(new java.awt.Font("Tahoma", 0, 10));
        jLabel17.setText("Orden de Trabajo:");

        jTOrdenTrabajo.setText("---");
        jTOrdenTrabajo.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jTOrdenTrabajoKeyPressed(evt);
            }
        });

        jBQuitarDetalle.setIcon(new javax.swing.ImageIcon(getClass().getResource("/iconos/remove.gif"))); // NOI18N
        jBQuitarDetalle.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jBQuitarDetalleActionPerformed(evt);
            }
        });

        jBMostrarTotales.setIcon(new javax.swing.ImageIcon(getClass().getResource("/iconos/remove.gif"))); // NOI18N
        jBMostrarTotales.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jBMostrarTotalesActionPerformed(evt);
            }
        });

        jTTotal.setDisabledTextColor(new java.awt.Color(0, 0, 0));

        jLabel21.setFont(new java.awt.Font("Tahoma", 0, 10));
        jLabel21.setText("Sup. Camb. Techo");

        javax.swing.GroupLayout jPanel6Layout = new javax.swing.GroupLayout(jPanel6);
        jPanel6.setLayout(jPanel6Layout);
        jPanel6Layout.setHorizontalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 382, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(10, 10, 10)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel6Layout.createSequentialGroup()
                        .addComponent(jBMostrarTotales, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel16, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel21)))
                    .addGroup(jPanel6Layout.createSequentialGroup()
                        .addComponent(jBQuitarDetalle, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel15)
                            .addComponent(jLabel6)))
                    .addComponent(jLabel17, javax.swing.GroupLayout.PREFERRED_SIZE, 93, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jTOrdenTrabajo)
                    .addComponent(jTSuperficieProyecto)
                    .addComponent(jTSuperficieRelevada, javax.swing.GroupLayout.DEFAULT_SIZE, 85, Short.MAX_VALUE)
                    .addComponent(jTCambioTecho, javax.swing.GroupLayout.DEFAULT_SIZE, 85, Short.MAX_VALUE)
                    .addComponent(jTTotal, javax.swing.GroupLayout.DEFAULT_SIZE, 81, Short.MAX_VALUE))
                .addContainerGap(1, Short.MAX_VALUE))
        );
        jPanel6Layout.setVerticalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel6Layout.createSequentialGroup()
                        .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel6)
                            .addComponent(jTSuperficieRelevada, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel15)
                            .addComponent(jTSuperficieProyecto, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addComponent(jBQuitarDetalle, javax.swing.GroupLayout.PREFERRED_SIZE, 32, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jBMostrarTotales, javax.swing.GroupLayout.PREFERRED_SIZE, 32, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(jPanel6Layout.createSequentialGroup()
                        .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel21)
                            .addComponent(jTCambioTecho, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel16)
                            .addComponent(jTTotal, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel17)
                    .addComponent(jTOrdenTrabajo, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(16, 16, 16))
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addComponent(jScrollPane3, javax.swing.GroupLayout.DEFAULT_SIZE, 140, Short.MAX_VALUE)
                .addContainerGap())
        );

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addComponent(jPanel6, javax.swing.GroupLayout.Alignment.LEADING, 0, 623, Short.MAX_VALUE)
                    .addComponent(jPanel4, javax.swing.GroupLayout.Alignment.LEADING, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel5, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel3, javax.swing.GroupLayout.Alignment.LEADING, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel2, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(4, 4, 4)
                .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel5, javax.swing.GroupLayout.PREFERRED_SIZE, 105, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel6, javax.swing.GroupLayout.PREFERRED_SIZE, 169, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jBGuardar.setText("Guardar");
        jBGuardar.setToolTipText("Guarda la constancia");
        jBGuardar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jBGuardarActionPerformed(evt);
            }
        });

        jBSalir.setText("Salir");
        jBSalir.setToolTipText("Sale de la ventana");
        jBSalir.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jBSalirActionPerformed(evt);
            }
        });

        jBImprimir.setText("Imprimir");
        jBImprimir.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jBImprimirActionPerformed(evt);
            }
        });

        jBNueva.setText("Nueva");
        jBNueva.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jBNuevaActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(layout.createSequentialGroup()
                        .addGap(104, 104, 104)
                        .addComponent(jBNueva, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jBImprimir, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jBGuardar, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jBSalir, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jBSalir, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jBGuardar, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jBImprimir)
                    .addComponent(jBNueva))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void jBGuardarActionPerformed(java.awt.event.ActionEvent evt)//GEN-FIRST:event_jBGuardarActionPerformed
    {//GEN-HEADEREND:event_jBGuardarActionPerformed
// TODO add your handling code here:
        System.out.println("El metodo controlar devuelve "+String.valueOf(this.controlar()));
        if(this.controlar())
            if(this.fechaCorrectaControl()){
                this.guardarCP();
            }else{
                JOptionPane.showMessageDialog(null, "La fecha debe ser correcta con el formato: DD/MM/AAAA", "Formato de fecha incorrecta",JOptionPane.ERROR_MESSAGE);
            }         
        else
            JOptionPane.showMessageDialog(null, "Debe llenar todos los campos", "Faltan Datos o estan incorrectos",JOptionPane.ERROR_MESSAGE);
        
    }//GEN-LAST:event_jBGuardarActionPerformed

    private void jBSalirActionPerformed(java.awt.event.ActionEvent evt)//GEN-FIRST:event_jBSalirActionPerformed
    {//GEN-HEADEREND:event_jBSalirActionPerformed
// TODO add your handling code here:
        this.dispose();
    }//GEN-LAST:event_jBSalirActionPerformed

    private void jCSerieActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jCSerieActionPerformed
        // TODO add your handling code here:
        cargarNroConstancia();
    }//GEN-LAST:event_jCSerieActionPerformed

    private void jBUbicacionActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jBUbicacionActionPerformed
        // TODO add your handling code here:
//        this.ubicacion = false;
        UIEligeDireccionBarrio barrios=new UIEligeDireccionBarrio(this,"JUJUY");
        barrios.setVisible(true);
}//GEN-LAST:event_jBUbicacionActionPerformed

    private void jBQuitarDetalleActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jBQuitarDetalleActionPerformed
        // TODO add your handling code here:
        if (this.jTableDetalle.getSelectedRow()!=-1)
        {
            this.quitarLineaDetalle();
            this.jTSuperficieProyecto.setText("");
            this.jTSuperficieRelevada.setText("");
            this.jTCambioTecho.setText("");
            this.calcular();
        }
        else
            JOptionPane.showMessageDialog(this, "Debe seleccionar una fila de la tabla...","Atencion", JOptionPane.INFORMATION_MESSAGE);
    }//GEN-LAST:event_jBQuitarDetalleActionPerformed

    private void jTMatriculaKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTMatriculaKeyReleased
    }//GEN-LAST:event_jTMatriculaKeyReleased

    @SuppressWarnings("static-access")
    private void jTMatriculaKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTMatriculaKeyPressed
        // TODO add your handling code here:
         char c = evt.getKeyChar();
        if (!((Character.isDigit(c) || (c == evt.VK_BACK_SPACE) ||(c == evt.VK_ENTER) ||(c == evt.VK_DELETE)  ||(c == evt.VK_ESCAPE))))
        {    
            getToolkit().beep();
            JOptionPane.showMessageDialog(null,"Debe introducir un valor valido ej: 12","Atencion",JOptionPane.ERROR_MESSAGE);
            this.jTMatricula.setText("");
            this.jTMatricula.requestFocus();
            evt.consume();
        }
        if(evt.getKeyCode()==27)
            this.dispose();
        if(evt.getKeyChar()==10){
            this.agregarMatriculadoATabla();
        }
            //this.jBAgregarMatriculado.requestFocus();

    }//GEN-LAST:event_jTMatriculaKeyPressed

    private void jBQuitarMatriculadoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jBQuitarMatriculadoActionPerformed
        // TODO add your handling code here:
        if (this.jTableParticipantes.getSelectedRow()!=-1)
        {
            this.quitarMatriculado();
        }else{
            JOptionPane.showMessageDialog(this, "Debe seleccionar una fila de la tabla...","Atencion", JOptionPane.INFORMATION_MESSAGE);
        }
        
        
    }//GEN-LAST:event_jBQuitarMatriculadoActionPerformed

    private void jTableTrabajosMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jTableTrabajosMouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_jTableTrabajosMouseClicked

    private void jTableTrabajosMouseReleased(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jTableTrabajosMouseReleased
        // TODO add your handling code here:
        int x = this.jTableTrabajos.getSelectedRow();
        int y = this.jTableTrabajos.getSelectedColumn();
        if(String.valueOf(this.jTableTrabajos.getValueAt(x, y)).trim().equals("true"))
            for(int i=0;i<this.jTableTrabajos.getRowCount();i++)
                if(i != x)
                    this.jTableTrabajos.setValueAt(false,i,y);
        if(this.jTCambioTecho.getText().trim().length() != 0)
            this.calcular();
    }//GEN-LAST:event_jTableTrabajosMouseReleased

    private void jTableDetalleKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTableDetalleKeyReleased
        // TODO add your handling code here:
        if(evt.getKeyCode()==10)
        {
            int x = this.jTableDetalle.getSelectedRow();
            int y = this.jTableDetalle.getSelectedColumn();
            //if((x == (this.jTableDetalle.getRowCount()-1)) || (x == 0))
            if(x == 0)
            {
                if(y == 0)
                    if(this.controlarDetalle(x))
                    {
                        this.calcular();
                        //if(x == (this.jTableDetalle.getRowCount() - 1))
                        if(this.jTableDetalle.getValueAt((this.jTableDetalle.getRowCount() - 1),3) != null)
                            this.agregarLineaDetalle();
                    }
                    
                    else
                        JOptionPane.showMessageDialog(null,"Debe llenar todas las celdas de la linea de detalle", "Faltan datos",JOptionPane.ERROR_MESSAGE);
            }
            else
                if(y == 0)
                    this.calcular();
        }
    }//GEN-LAST:event_jTableDetalleKeyReleased

    private void jBNuevaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jBNuevaActionPerformed
        // TODO add your handling code here:
        this.nuevaConstancia();
    }//GEN-LAST:event_jBNuevaActionPerformed

    private void jBImprimirActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jBImprimirActionPerformed
        // TODO add your handling code here:
        this.imprimir();
    }//GEN-LAST:event_jBImprimirActionPerformed

    private void jTNombrePropietarioKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTNombrePropietarioKeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==27)
            this.dispose();
        if(evt.getKeyChar()==10)
            this.jTNombreComitente.requestFocus();

    }//GEN-LAST:event_jTNombrePropietarioKeyPressed

    private void jTNombreComitenteKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTNombreComitenteKeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==27)
            this.dispose();
        if(evt.getKeyChar()==10)
            this.jTMatricula.requestFocus();

    }//GEN-LAST:event_jTNombreComitenteKeyPressed

    private void jTCalleKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTCalleKeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==27)
            this.dispose();
        if(evt.getKeyChar()==10)
            this.jTNumero.requestFocus();

    }//GEN-LAST:event_jTCalleKeyPressed

    private void jTNumeroKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTNumeroKeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==27)
            this.dispose();
        if(evt.getKeyChar()==10)
            this.jTManzana.requestFocus();

    }//GEN-LAST:event_jTNumeroKeyPressed

    private void jTManzanaKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTManzanaKeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==27)
            this.dispose();
        if(evt.getKeyChar()==10)
            this.jTLote.requestFocus();
    }//GEN-LAST:event_jTManzanaKeyPressed

    private void jTableDetalleKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTableDetalleKeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==27)
            this.dispose();
        
        
    }//GEN-LAST:event_jTableDetalleKeyPressed

    private void jTableParticipantesKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTableParticipantesKeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==27)
            this.dispose();

    }//GEN-LAST:event_jTableParticipantesKeyPressed

    private void jTOrdenTrabajoKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTOrdenTrabajoKeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==27)
            this.dispose();
        if(evt.getKeyChar()==10)
            this.jBGuardar.requestFocus();

    }//GEN-LAST:event_jTOrdenTrabajoKeyPressed

    private void jTFechaKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTFechaKeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==27)
            this.dispose();
        if(evt.getKeyChar()==10)
            this.jCSerie.requestFocus();

    }//GEN-LAST:event_jTFechaKeyPressed

    private void jCSerieKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jCSerieKeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==27)
            this.dispose();
        if(evt.getKeyChar()==10)
            this.jTNumeroConstancia.requestFocus();

    }//GEN-LAST:event_jCSerieKeyPressed

    private void jTNumeroConstanciaKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTNumeroConstanciaKeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==27)
            this.dispose();
        if(evt.getKeyChar()==10)
            this.jTNombrePropietario.requestFocus();
    }//GEN-LAST:event_jTNumeroConstanciaKeyPressed

    private void jTNumeroFacturaKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTNumeroFacturaKeyPressed
        // TODO add your handling code here:
}//GEN-LAST:event_jTNumeroFacturaKeyPressed

    private void jTSerieFacturaKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTSerieFacturaKeyPressed
        // TODO add your handling code here:
}//GEN-LAST:event_jTSerieFacturaKeyPressed

    private void jBMostrarTotalesActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jBMostrarTotalesActionPerformed
        // TODO add your handling code here:
        UIMostrarTotales ui = new UIMostrarTotales(this,true);
        ui.mostrar(this.mostrarTotales);
        ui.setVisible(true);
}//GEN-LAST:event_jBMostrarTotalesActionPerformed
    
    /**
     * @param args the command line arguments
     */
    public static void main(String args[])
    {
        java.awt.EventQueue.invokeLater(new Runnable()
        {
            public void run()
            {
                new UINuevaCP().setVisible(true);
            }
        });
    }
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton jBGuardar;
    private javax.swing.JButton jBImprimir;
    private javax.swing.JButton jBMostrarTotales;
    private javax.swing.JButton jBNueva;
    private javax.swing.JButton jBQuitarDetalle;
    private javax.swing.JButton jBQuitarMatriculado;
    private javax.swing.JButton jBSalir;
    private javax.swing.JButton jBUbicacion;
    private javax.swing.JComboBox jCSerie;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JLabel jLabel17;
    private javax.swing.JLabel jLabel18;
    private javax.swing.JLabel jLabel19;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel20;
    private javax.swing.JLabel jLabel21;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JTextField jTBarrio;
    private javax.swing.JTextField jTCalle;
    private javax.swing.JTextField jTCambioTecho;
    private javax.swing.JTextField jTDepartamento;
    private javax.swing.JTextField jTFecha;
    private javax.swing.JTextField jTLocalidad;
    private javax.swing.JTextField jTLote;
    private javax.swing.JTextField jTManzana;
    private javax.swing.JTextField jTMatricula;
    private javax.swing.JTextField jTNombreComitente;
    private javax.swing.JTextField jTNombrePropietario;
    private javax.swing.JTextField jTNumero;
    private javax.swing.JTextField jTNumeroConstancia;
    private javax.swing.JTextField jTNumeroFactura;
    private javax.swing.JTextField jTOrdenTrabajo;
    private javax.swing.JTextField jTProvincia;
    private javax.swing.JTextField jTSerieFactura;
    private javax.swing.JTextField jTSuperficieProyecto;
    private javax.swing.JTextField jTSuperficieRelevada;
    private javax.swing.JTextField jTTotal;
    private javax.swing.JTable jTableDetalle;
    private javax.swing.JTable jTableParticipantes;
    private javax.swing.JTable jTableTrabajos;
    // End of variables declaration//GEN-END:variables
    
    
    
 private void inicializarFormulario()
 {
    this.cargarFecha();
    this.llenarSeriesActivas();
    this.cargarNroConstancia();
    this.cargarOpcionesDeDetalle();
    this.ajustarTabla();
    this.jBImprimir.setEnabled(false);
    this.jBNueva.setEnabled(false);
    this.jBSalir.setEnabled(true);
    this.jBGuardar.setEnabled(true);
 }

 private void cargarFecha(){
//        Obtenemos la fecha actual del sistema
        Date fecha=new Date();//fecha actual
        //DateFormat df=DateFormat.getInstance();// 
        DateFormat df=DateFormat.getDateInstance();        
        this.jTFecha.setText(df.format(fecha));
    }
 private void llenarSeriesActivas(){       
 /**
  * Llena las series Activas en el combobox de series de la ventana * 
  * Donde incialmente aparecera seleccionado la serie que se encuentra        
  * por defecto.
 **/   
        CListar listar = new CListar();
        SerieConstancia ser=new SerieConstancia();
        ser.setActivo("S");
        
        series = listar.hacerListado(ser);
        listar = null;
        Iterator it = series.iterator();
        SerieConstancia s = new SerieConstancia();
        while(it.hasNext()){
            s = (SerieConstancia)it.next();
            if (s.getTipoConstancia().trim().equals("P")){//Solo carga las series de CONST PARCIALES
                this.jCSerie.addItem(s.getSerie().trim());
                if (s.getDefecto().trim().equals("S")){
                    this.jCSerie.setSelectedItem(s.getSerie().trim());
                }
            }
        }            
       
        s = null;
        it = null;        
  }
  private void cargarNroConstancia(){
  /*
   *Carga el numero de constancia parcial correspondiente para una nueva constancia
   *de acuerdo a la Serie Elegida 
   */    
      if(this.esAutomatico())
      {
        this.jTNumeroConstancia.setEnabled(false);        
        EncabezadoCP encCP=new EncabezadoCP();
        encCP.setSerieCP(this.jCSerie.getSelectedItem().toString().trim());
        
        CUltimo nroCP=new CUltimo();        
        nroConst=nroCP.getUltimo(encCP);
        
        //this.jTNumeroConstancia.setText(String.valueOf(nroConst)); 
        this.jTNumeroConstancia.setText("Nro Automatico"); 
        this.jTNumeroFactura.setEnabled(false);
        this.jTSerieFactura.setEnabled(false);
        nroCP = null;
        encCP = null;
      }
      else
      {
          this.jTNumeroConstancia.setText(""); 
          this.jTNumeroConstancia.setEnabled(true);
          this.jTNumeroFactura.setEnabled(true);
          this.jTSerieFactura.setEnabled(true);
      }
          
  }
  public void cargarOpcionesDeDetalle(){
        //Obtengo del Modelo del jtable la TABLECOLUMN
        TableColumn columnaTrabajo = this.jTableDetalle.getColumnModel().getColumn(0);
        TableColumn columnaSuperficie = this.jTableDetalle.getColumnModel().getColumn(1);
        TableColumn columnaSeccion = this.jTableDetalle.getColumnModel().getColumn(2);
        //Obtengo las colecciones de tipos de trabajos y superficies y secciones
        CListar listaTrabajos=new CListar();
        this.tiposTrabajos= listaTrabajos.hacerListado(new TipoTrabajo());
        CListar listaSuperficies=new CListar();
        this.tiposSuperficies= listaSuperficies.hacerListado(new TipoSuperficie());
        CListar listaSecciones=new CListar();
        this.tiposSecciones= listaSecciones.hacerListado(new TipoSeccion());
        
        
        JComboBox comboBoxTipoTrabajo = new JComboBox();
        JComboBox comboBoxTipoSuperficie = new JComboBox();
        JComboBox comboBoxTipoSeccion = new JComboBox();
        
        Iterator it1=this.tiposTrabajos.iterator();
        while (it1.hasNext()){
            TipoTrabajo tipoT=(TipoTrabajo)it1.next();
            comboBoxTipoTrabajo.addItem(tipoT.getNombre());
        }
        
        Iterator it2=this.tiposSuperficies.iterator();
        while (it2.hasNext()){
            TipoSuperficie tipoS=(TipoSuperficie)it2.next();
            comboBoxTipoSuperficie.addItem(tipoS.getNombre());
        }
        
        Iterator it3=this.tiposSecciones.iterator();
        while (it3.hasNext()){
            TipoSeccion tipoSe=(TipoSeccion)it3.next();
            comboBoxTipoSeccion.addItem(tipoSe.getNombre());
        }
        
        comboBoxTipoTrabajo.setSelectedIndex(0);
        comboBoxTipoSuperficie.setSelectedIndex(0);
        comboBoxTipoSeccion.setSelectedIndex(0);
        
        columnaTrabajo.setCellEditor(new DefaultCellEditor(comboBoxTipoTrabajo));
        columnaSuperficie.setCellEditor(new DefaultCellEditor(comboBoxTipoSuperficie));
        columnaSeccion.setCellEditor(new DefaultCellEditor(comboBoxTipoSeccion));
        
  }
  
  public void cargarDatosDireccion(Barrio bar)
    {
        boolean ubicacion=true;
        
        if(ubicacion)// ubicacion laboral
        {
            Consulta con = new Consulta();
            int idJujuy = 0;
            Collection co = new ArrayList();
            co = con.getProvincia("JUJUY");
            Iterator it = co.iterator();
            while(it.hasNext())
            {
                Provincia p = (Provincia)it.next();
                if(p.getNombre().trim().equals("JUJUY"))
                    idJujuy = p.getIdprovincia();
                p = null;
            }
            co = null;
            con = null;
            it = null;
            if(bar.getLocalidad().getDepartamento().getProvincia().getIdprovincia() == idJujuy)
            {
                this.jTProvincia.setText(bar.getLocalidad().getDepartamento().getProvincia().getNombre().trim());
                this.jTDepartamento.setText(bar.getLocalidad().getDepartamento().getNombre().trim());
                this.jTLocalidad.setText(bar.getLocalidad().getNombre().trim());
                this.jTBarrio.setText(bar.getNombre().trim());
                this.localidad = bar.getLocalidad();
                this.barrio = bar;
                this.departamento = bar.getLocalidad().getDepartamento();
                this.provincia = bar.getLocalidad().getDepartamento().getProvincia();
            }
            else
                JOptionPane.showMessageDialog(null,"EL domicilio laboral debe estar ubicado en la provincia de Jujuy","Error en el domicilio",JOptionPane.ERROR_MESSAGE);
        }       
    }
    
    public Matriculado buscarMatriculado(String mat){
        CListar lista=new CListar();
        Matriculado m=new Matriculado();
        m.setMatricula(Integer.parseInt(mat.trim()));           
        Matriculado matri=lista.soloMatriculado(m);
          
        return matri;        
    }
    
    public void agregarMatriculadoATabla(){
        if (this.jTMatricula.getText().trim().equals("")){
            JOptionPane.showMessageDialog(this, "Agregue un numero de matricula en el campo Matricula","Atencion", JOptionPane.INFORMATION_MESSAGE);        
        }else{
            Matriculado mat=this.buscarMatriculado(this.jTMatricula.getText().trim());
            if (mat.getMatricula()!=0){
                if(this.validarMatriculado(Integer.parseInt(this.jTMatricula.getText()))){
                    this.agregarLineaMatriculado(mat);
                    if (!solicitanteCargado){
                        this.matriculado=mat;
                        solicitanteCargado=true;
                        JOptionPane.showMessageDialog(this, "Este Matriculado sera el solicitante de esta constancia","Atencion", JOptionPane.INFORMATION_MESSAGE);
                    }
                } else{
                    JOptionPane.showMessageDialog(this, "El Matriculado ya fue cargado","Atencion", JOptionPane.INFORMATION_MESSAGE);
                    this.jTMatricula.requestFocus();
                }                   
                this.jTMatricula.setText("");
            }else{
                JOptionPane.showMessageDialog(this, "El Matriculado no existe en la Base de Datos...","Atencion", JOptionPane.INFORMATION_MESSAGE);
            }
        }   
    }
    
 /*   
    private void llenarTablaMatriculados(Collection mats)
    {   
        Matriculado m=new Matriculado();
        Iterator it = mats.iterator();
        // ahora obtengo el modelo de la tabla
        DefaultTableModel modelo = (DefaultTableModel)this.jTableParticipantes.getModel();
        String datos[] = new String[4];
        while(it.hasNext())
        {
            m = (Matriculado)it.next();
            datos[0] = String.valueOf(m.getIdmatriculado());
            datos[1] = String.valueOf(m.getMatricula());
            datos[2] = m.getApellido();
            datos[3] = m.getNombres();            
            modelo.addRow(datos);
        }
    }
  */
    private void agregarLineaMatriculado(Matriculado m){
        DefaultTableModel  modelo=new DefaultTableModel();
        modelo=(DefaultTableModel) this.jTableParticipantes.getModel();
        String datos[]=new String[4];
        datos[0]=String.valueOf(m.getIdmatriculado());
        datos[1]=String.valueOf(m.getMatricula());
        datos[2]=m.getApellido();
        datos[3]=m.getNombres();
        modelo.addRow(datos);    
        Boolean dat[] = new Boolean[this.tamanioVector];
        DefaultTableModel mod = (DefaultTableModel)this.jTableTrabajos.getModel();
        for(int i=0;i<this.tamanioVector;i++)
            dat[i] = false;
        mod.addRow(dat);
        datos = null;
        dat = null;
    
    }
    
    private void limpiarTablaMatriculados()
    {
        DefaultTableModel modelo = (DefaultTableModel)this.jTableParticipantes.getModel();
        DefaultTableModel modelo2 = (DefaultTableModel)this.jTableTrabajos.getModel();
        while(this.jTableParticipantes.getRowCount() != 0)
        {
            modelo.removeRow(0);
            modelo2.removeRow(0);
        }
                
        modelo = null;
    }
    private void agregarLineaDetalle(){
        DefaultTableModel  modelo=new DefaultTableModel();
        modelo=(DefaultTableModel) this.jTableDetalle.getModel();
        Vector datos = new Vector();
        //String datos[]=new String[4];
        datos.add(new String());
        datos.add(new String());
        datos.add(new String());
        /*datos[0]="";
        datos[1]="";
        datos[2]="";
        datos[3]="";*/
        modelo.addRow(datos);    
    }
    private void quitarLineaDetalle()
    {
        DefaultTableModel  modelo=new DefaultTableModel();
        modelo=(DefaultTableModel) this.jTableDetalle.getModel();       
        modelo.removeRow(this.jTableDetalle.getSelectedRow());    
        if(this.jTableDetalle.getRowCount() == 0)
            this.agregarLineaDetalle();
    }
    
    private void quitarDetalles()
    {
        DefaultTableModel  modelo=new DefaultTableModel();
        modelo=(DefaultTableModel) this.jTableDetalle.getModel();
        while(this.jTableDetalle.getRowCount() != 0)
            modelo.removeRow(0);
        this.agregarLineaDetalle();
    }
    private void quitarMatriculado()
    {
        int fila;
        DefaultTableModel  modelo=new DefaultTableModel();
        DefaultTableModel  modelo2=new DefaultTableModel();
        modelo = (DefaultTableModel) this.jTableParticipantes.getModel();       
        fila = this.jTableParticipantes.getSelectedRow();
        modelo2 = (DefaultTableModel) this.jTableTrabajos.getModel();       
        modelo.removeRow(fila);
        modelo2.removeRow(fila);
        
        //Si quita hasta el ultimo matriculado entonces ya no va a
        //ser el mismo solicitante, el solicitante va  a cambiar
        if (this.jTableParticipantes.getRowCount()==0 && solicitanteCargado){
            JOptionPane.showMessageDialog(this, "Se va a cambiar el solicitante de esta constancia","Atencion", JOptionPane.INFORMATION_MESSAGE);
            solicitanteCargado=false;
            this.matriculado=null;            
        }  
    }
    
    /// marcelo ///
    
    private void getTasas()
    {
        CListar listar = new CListar();
        this.tasas = listar.hacerListado(new Tasa());
        listar = null;
    }
    
    private Tasa getTasa(int id)
    {
        Iterator it = this.tasas.iterator();
        Tasa t = new Tasa();
        Tasa tasa = new Tasa();
        while(it.hasNext())
        {
            t = (Tasa)it.next();
            if(t.getIdtasa() == id)
                tasa = t;
        }
        t = null;
        it = null;
        return tasa;
    }
    
    private void getDoc()
    {
        CListar listar = new CListar();
        Collection temp = listar.hacerListado(new Documento());
        Iterator it = temp.iterator();
        
        while(it.hasNext())
        {
            Documento d = (Documento)it.next();
            if(d.getDescripcion().trim().equals("CONSTANCIA PARCIAL"))
                documento = d;
            d = null;
        }
        it = null;
        temp = null;
        listar = null;
    }
    private void getTasasAplicables()
    {
        CListar listar = new CListar();
        Collection tempo = listar.hacerListadoTasaAplicable(new TasaAplicable());
        Iterator it = tempo.iterator();
        TasaAplicable t = new TasaAplicable();
        while(it.hasNext())
        {
            t = (TasaAplicable)it.next();
            if(t.getIdTipoConstancia() == this.documento.getIdDocumento())
                this.tasasAplicables.add(t);
                
        }
        tempo = null;
        it = null;
        t = null;
    }
    
    private void limpiarColumnas()
    {
        int columnas =  this.jTableTrabajos.getColumnCount();
        for(int i=0;i<columnas;i++)
            removeColumnAndData(0);
    }
    
    private void limpiarUbicacion()
    {
        this.jTProvincia.setText("");
        this.jTLocalidad.setText("");
        this.jTDepartamento.setText("");
        this.jTBarrio.setText("");
        this.jTCalle.setText("---");
        this.jTLote.setText("---");
        this.jTManzana.setText("---");
        this.jTNumero.setText("---");
    }
    
    private void limpiarComitente()
    {
        this.jTNombrePropietario.setText("");
        this.jTNombreComitente.setText("");
        this.jTMatricula.setText("");
    }
    
    private void limpiarSuperficieYTotal()
    {
        this.jTSuperficieProyecto.setText("");
        this.jTSuperficieRelevada.setText("");
        this.jTCambioTecho.setText("");
        this.jTOrdenTrabajo.setText("---");
    }
    
    public void removeColumnAndData(int vColIndex) 
    {
        DefaultTableModel model = (DefaultTableModel)this.jTableTrabajos.getModel();
        Vector colIds = new Vector();
        // aqui solo relleno el vector de ids de columna con las columnas que quedan
        for(int i=0;i<this.jTableTrabajos.getColumnCount();i++)
            colIds.add(i);
        
        TableColumn col = this.jTableTrabajos.getColumnModel().getColumn(vColIndex);
        int columnModelIndex = col.getModelIndex();
        Vector data = model.getDataVector();
        //Vector colIds = model.getColumnIdentifiers();
    
        // Remove the column from the table
        this.jTableTrabajos.removeColumn(col);
    
        // Remove the column header from the table model
        colIds.removeElementAt(columnModelIndex);
    
        // Remove the column data
        for (int r=0; r<data.size(); r++) 
        {
            Vector row = (Vector)data.get(r);
            row.removeElementAt(columnModelIndex);
        }
        model.setDataVector(data, colIds);
    
        // Correct the model indices in the TableColumn objects
        // by decrementing those indices that follow the deleted column
        Enumeration enumm = this.jTableTrabajos.getColumnModel().getColumns();
        for (; enumm.hasMoreElements(); ) 
        {
            TableColumn c = (TableColumn)enumm.nextElement();
            if (c.getModelIndex() >= columnModelIndex) {
                c.setModelIndex(c.getModelIndex()-1);
            }
        }
        model.fireTableStructureChanged();
    }
    
    private void ajustarTabla()
    {
       // limpio la coleccion que tiene los objetos tasaAplicable que pertenecen al documento
        this.tasasAplicables.clear();
        this.getDoc();
        // limpio las columnas de la tabla
        this.limpiarColumnas();
        // obtengo una coleccion con los objetos tasa que corresponden al documento
        this.getTasas();
        this.getTasasAplicables();
        // cargo un vector con el numero de orden de las tasas
        Iterator it = this.tasasAplicables.iterator();
        TasaAplicable t = new TasaAplicable();
        int contador = 0;
        int i = 1;
        while(it.hasNext())
        {
            t = (TasaAplicable)it.next();
            this.vector[contador] = i;
            this.vectorTrabajo[contador] = t;
            contador = i;
            this.tamanioVector = i;
            i++;
        }
        t = null;
        it = null;
        this.nuevasColumnas();
    }
    
    private void nuevasColumnas()
    {
        Iterator it = this.tasasAplicables.iterator();
        
        DefaultTableModel modelo = (DefaultTableModel)this.jTableTrabajos.getModel();
        TasaAplicable t = new TasaAplicable();
        while(it.hasNext())
        {
            t = (TasaAplicable)it.next();
            modelo.addColumn(this.getTasa(t.getIdtasa()).getDenominacion().trim());
        }
        t = null;
        it = null;
    }
    
    private boolean validarMatriculado(int matricula)
    {
        boolean bandera = true;
        for(int i=0; i<this.jTableParticipantes.getRowCount();i++)
            if(Integer.parseInt(String.valueOf(this.jTableParticipantes.getValueAt(i, 1))) == matricula)
                bandera = false;
        return bandera;
    }
    
    private Tasa obtenerTasa(int orden)
    {
        Tasa tasa = new Tasa();
        int contador = 0;
        Iterator it = this.tasasAplicables.iterator();
        while(it.hasNext())
        {
            TasaAplicable t = (TasaAplicable)it.next();
            if(contador == orden)
                tasa = this.getTasa(t.getIdtasa());
            contador++;
            t = null;
        }
        it = null;
        return tasa;
    }
    
    private Collection getValores()
    {
        Collection valores = new ArrayList();
        // primero recorro el jtable para saber cuales campos estan en true
        for(int i=0;i<this.jTableTrabajos.getRowCount();i++)
            for(int j=0;j<this.tamanioVector;j++)
                if(Boolean.parseBoolean(String.valueOf(this.jTableTrabajos.getValueAt(i, j))))
                    valores.add(this.obtenerTasa(j));
        return valores;
    }
    
    private TipoTrabajo getTrabajo(String nombre)
    {
        TipoTrabajo t = new TipoTrabajo();
        Iterator it = this.tiposTrabajos.iterator();
        while(it.hasNext())
        {
            TipoTrabajo ti = (TipoTrabajo)it.next();
            if(ti.getNombre().trim().equals(nombre.trim()))
                t = ti;
            ti = null;
        }
        it = null;
        return t;
    }

    private TipoSuperficie getSuperficie(String nombre)
    {
        TipoSuperficie t = new TipoSuperficie();
        Iterator it = this.tiposSuperficies.iterator();
        while(it.hasNext())
        {
            TipoSuperficie ti = (TipoSuperficie)it.next();
            if(ti.getNombre().trim().equals(nombre.trim()))
                t = ti;
            ti = null;
        }
        it = null;
        return t;
    }

    private TipoSeccion getSeccion(String nombre)
    {
        TipoSeccion t = new TipoSeccion();
        Iterator it = this.tiposSecciones.iterator();
        while(it.hasNext())
        {
            TipoSeccion ti = (TipoSeccion)it.next();
            if(ti.getNombre().trim().equals(nombre.trim()))
                t = ti;
            ti = null;
        }
        it = null;
        return t;
    }
 
    private double calcularSuperficie(int fila)
    {
        double superficie = 0.0;
        TipoSuperficie sup = new TipoSuperficie();
        sup = this.getSuperficie(String.valueOf(this.jTableDetalle.getValueAt(fila, 1)));
        superficie = Double.parseDouble(String.valueOf(this.jTableDetalle.getValueAt(fila, 3))) * sup.getModificador();
        return superficie;
    }
    
    private void calcular()
    {
        double superficieRelevamiento = 0.0;
        double superficieProyecto = 0.0;
        double superficieCambioTecho = 0.0;
        this.mostrarTotales.clear();
        
            for(int i=0;i<this.jTableDetalle.getRowCount();i++)
            {
                if(this.jTableDetalle.getValueAt(i, 3) != null)
                {
                    if(String.valueOf(this.jTableDetalle.getValueAt(i, 0)).trim().equals("RELEVAMIENTO"))
                        superficieRelevamiento = superficieRelevamiento + this.calcularSuperficie(i);
                    else
                        if(String.valueOf(this.jTableDetalle.getValueAt(i, 0)).trim().equals("PROYECTO"))
                            superficieProyecto = superficieProyecto + this.calcularSuperficie(i);
                        else
                            if(String.valueOf(this.jTableDetalle.getValueAt(i, 0)).trim().equals("CAMBIO DE TECHO"))
                                superficieCambioTecho = superficieCambioTecho + this.calcularSuperficie(i);
                }
                    
            }
        this.jTSuperficieProyecto.setText(String.valueOf(superficieProyecto));
        this.jTSuperficieRelevada.setText(String.valueOf(superficieRelevamiento));
        this.jTCambioTecho.setText(String.valueOf(superficieCambioTecho));
        Collection valores = this.getValores();
        Iterator it = valores.iterator();
        double indiceRelevamiento = 0.0; // tiene el valor en pesos 
        double tasaMinimaCalculo = 0.0;
        double indiceConduccion = 0.0; // tiene el valor en pesos
        double indiceCalculo = 0.0; // tiene la suma de indices
        double indiceCambioTecho = 0.0;
        MostrarTotales mRelevamiento = new MostrarTotales();
        MostrarTotales mConduccion = new MostrarTotales();
        MostrarTotales mCalculo = new MostrarTotales();
        MostrarTotales mCambioTecho = new MostrarTotales();
        while(it.hasNext())
        {
            Tasa t = (Tasa)it.next();
            if(t.getDenominacion().trim().equals("RELEVAMIENTO"))
            {
                indiceRelevamiento = superficieRelevamiento * t.getIndice();
                if(indiceRelevamiento < t.getTasaMinima())
                    indiceRelevamiento = t.getTasaMinima();
                mRelevamiento.setDetalle(t.getDenominacion());
            }
                
            else
                if(t.getDenominacion().trim().equals("CONDUCCION TECNICA"))
                {
                    indiceConduccion = superficieProyecto * t.getIndice();
                    if(indiceConduccion < t.getTasaMinima())
                        indiceConduccion = t.getTasaMinima();
                    mConduccion.setDetalle(t.getDenominacion());
                }
                else
                    if(t.getDenominacion().trim().equals("CAMBIO DE TECHO"))
                    {
                        indiceCambioTecho = superficieCambioTecho * t.getIndice();
                        if(indiceCambioTecho < t.getTasaMinima())
                            indiceCambioTecho = t.getTasaMinima();
                        mCambioTecho.setDetalle(t.getDenominacion());
                    } 
                    else
                    {
                        indiceCalculo = indiceCalculo + t.getIndice();
                        tasaMinimaCalculo = t.getTasaMinima();
                        mCalculo.setDetalle(t.getDenominacion());
                    }
            t = null;
        }
        it = null;
        double totalCalculo = superficieProyecto * indiceCalculo;
        if(totalCalculo < tasaMinimaCalculo)
            totalCalculo = tasaMinimaCalculo;
        //if(indiceRelevamiento )
        double total1 = 0.0;
        total1 = indiceRelevamiento + indiceConduccion + totalCalculo + indiceCambioTecho;
        mCalculo.setTatal(totalCalculo);
        mRelevamiento.setTatal(indiceRelevamiento);
        mConduccion.setTatal(indiceConduccion);
        mCambioTecho.setTatal(indiceCambioTecho);
        this.mostrarTotales.add(mCalculo);
        this.mostrarTotales.add(mRelevamiento);
        this.mostrarTotales.add(mConduccion);
        this.mostrarTotales.add(mCambioTecho);
        total=total1;
        NumberFormat nf = NumberFormat.getCurrencyInstance();
        this.jTTotal.setText(nf.format(total));
    }
    
    private boolean controlarDetalle(int x)
    {
        boolean bandera = true;
        if(this.jTableDetalle.getValueAt(x,0) == null)
            bandera = false;
        if(this.jTableDetalle.getValueAt(x,1) == null)
            bandera = false;
        if(this.jTableDetalle.getValueAt(x,2) == null)
            bandera = false;
        if(this.jTableDetalle.getValueAt(x,3) == null)
            bandera = false;
//        if(this.jTableDetalle.getValueAt(x,3).toString().trim().length() == 0)
  //          bandera = false;
        if(this.jTableDetalle.getValueAt(x,0).toString().trim().length() == 0)
            bandera = false;
        if(this.jTableDetalle.getValueAt(x,1).toString().trim().length() == 0)
            bandera = false;
        if(this.jTableDetalle.getValueAt(x,2).toString().trim().length() == 0)
            bandera = false;
        //if(this.jTableDetalle.getValueAt(x,3).toString().trim().length() == 0)
          //  bandera = false;
        
        return bandera;
    }
    
    private boolean controlarTrabajos()
    {
        boolean bandera = true;
        int contador = 0;
        for(int i = 0;i<this.jTableTrabajos.getRowCount();i++)
        {
            contador = 0;
            for(int j=0;j<this.tamanioVector;j++)
                //if(Boolean.parseBoolean(this.jTableTrabajos.getValueAt(i,j).toString()))
                if(Boolean.parseBoolean(String.valueOf(this.jTableTrabajos.getValueAt(i,j))))
                    contador++;
        }
        if(contador == this.tamanioVector)
                bandera = true;
        return bandera;
    }
    private boolean fechaCorrectaControl(){
        Boolean fechaCorrecta=false;
        DateFormat df=DateFormat.getDateInstance();//el formato de fecha debe ser DD/MM/AAAA si quiero formato DD/MM/AAAA HH:MM:SS uso getInstance
        Date fecha;//fecha actual por defecto
        try{
            fecha=df.parse(this.jTFecha.getText().trim()); 
            fechaCorrecta=true;
        }catch(ParseException pe){
            //JOptionPane.showMessageDialog(null,"La fecha es incorrecta, escriba una valida\n del tipo: DD/MM/AAAA","Fecha Errónea",JOptionPane.ERROR_MESSAGE);
            fechaCorrecta=false;
        }        
        return fechaCorrecta;
    }
    
    private boolean controlar()
    {
        boolean bandera = true;        
        bandera = this.controlarTrabajos();
        if(this.jTNumeroConstancia.getText().trim().length()==0)
        {
            bandera = false;            
            JOptionPane.showMessageDialog(null,"Debe cargar un numero de constancia","Nro de Constancia nula",JOptionPane.ERROR_MESSAGE);
        }
        if(!this.esAutomatico())
        {
            if(this.jTNumeroFactura.getText().trim().length()==0)
            {
                bandera = false;            
                JOptionPane.showMessageDialog(null,"Debe cargar un numero de factura","Nro de Factura nula",JOptionPane.ERROR_MESSAGE);
            }
        
            if(this.jTSerieFactura.getText().trim().length()==0)
            {
                bandera = false;            
                JOptionPane.showMessageDialog(null,"Debe cargar el numero de serie de factura","Nro de serie de Factura nula",JOptionPane.ERROR_MESSAGE);
            }
        }
        
        
        if(this.jTNombrePropietario.getText().trim().length() == 0)
            bandera = false;
           
        if(this.jTNombreComitente.getText().trim().length() == 0)
            bandera = false;

        if(this.jTableParticipantes.getRowCount() == 0)
            bandera = false;
            
        // controlar ubicacion de la obra
        if(this.jTBarrio.getText().trim().length() == 0)
            bandera = false;
        if(this.jTCalle.getText().trim().length() == 0)
            bandera = false;
        if(this.jTNumero.getText().trim().length() == 0)
            bandera = false;
        if(this.jTManzana.getText().trim().length() == 0)
            bandera = false;
        if(this.jTLote.getText().trim().length() == 0)
            bandera = false;
        // controlar las tasas aplicadas
        if(this.jTSuperficieProyecto.getText().trim().length() == 0)
            bandera = false;
        if(this.jTSuperficieRelevada.getText().trim().length() == 0)
            bandera = false;
        if(this.jTCambioTecho.getText().trim().length() == 0)
            bandera = false;
        return bandera;
    }
    
     private void guardarCP(){
        EncabezadoCP encabezadoCP=new EncabezadoCP();        
        //Asigno Valores a la clase encabezadoCP que se  va a almacenar
        DateFormat df=DateFormat.getDateInstance();// 
        Date fecha=new Date();//fecha actual por defecto
        try{
            fecha=df.parse(this.jTFecha.getText().trim());
        }catch(ParseException pe){
            JOptionPane.showMessageDialog(null,"La fecha es incorrecta, escriba una valida\n del tipo: dd-mm-aa, se almacenara con la fecha de hoy","Fecha Errónea",JOptionPane.ERROR_MESSAGE);
        }        
//        System.out.println("Se guardo con fecha: "+fecha);
        
        
        encabezadoCP.setFecha(fecha);        
        
        encabezadoCP.setMatriculado(matriculado);        
        encabezadoCP.setSerieCP(this.jCSerie.getSelectedItem().toString().trim().toUpperCase());
        if(this.esAutomatico()){
            //encabezadoCP.setCodigoCP(Long.valueOf(this.jTNumeroConstancia.getText().trim()));
            encabezadoCP.setCodigoCP(this.nroConst);
            this.jTNumeroConstancia.setText(String.valueOf(encabezadoCP.getCodigoCP()).trim());
        }else
            if(!this.controlarNumeroRepetido())
                JOptionPane.showMessageDialog(null, "El numero de constancia ingresado ya existe, cargue otro numero", "Error de duplicacion de clave", JOptionPane.ERROR_MESSAGE);
            else{
                encabezadoCP.setCodigoCP(Long.valueOf(this.jTNumeroConstancia.getText().trim()));
                this.nroConst = Long.valueOf(this.jTNumeroConstancia.getText().trim());
                encabezadoCP.setNumeroFactura(Long.parseLong(this.jTNumeroFactura.getText()));
                encabezadoCP.setSerieFactura(Integer.parseInt(this.jTSerieFactura.getText()));
            }
                
        encabezadoCP.setProvincia(this.provincia);
        encabezadoCP.setDepartamento(this.departamento);
        encabezadoCP.setLocalidad(this.localidad);
        encabezadoCP.setBarrrio(this.barrio);
        
        
        encabezadoCP.setPropietario(this.jTNombrePropietario.getText().trim().toUpperCase());
        encabezadoCP.setComitente(this.jTNombreComitente.getText().trim().toUpperCase());                      
        encabezadoCP.setCalle(this.jTCalle.getText().trim());
        encabezadoCP.setNumero(this.jTNumero.getText().trim());
        encabezadoCP.setManzana(this.jTManzana.getText().trim());
        encabezadoCP.setLote(this.jTLote.getText().trim());
        encabezadoCP.setAnulado("N");
        encabezadoCP.setSuperficieRelevada(Double.parseDouble(this.jTSuperficieRelevada.getText().trim()));
        encabezadoCP.setSuperficieProyecto(Double.parseDouble(this.jTSuperficieProyecto.getText().trim()));
        encabezadoCP.setTotal(total);
        encabezadoCP.setOrdenTrabajo(this.jTOrdenTrabajo.getText().trim().toUpperCase());      
        encabezadoCP.setUsuario(this.usuario);         
        
        Boolean guardoBien=false;
        CAlta alta=new CAlta();
        int respuesta=alta.hacerAltaEncabezadoCP(encabezadoCP, this.esAutomatico());
        if (respuesta==0){
            guardoBien=true;
            for(int fila=0;fila<this.jTableDetalle.getRowCount();fila++)
            {
                if(this.controlarDetalle(fila))
                {
                    int resp=this.guardarDetalleCP(fila);
                    if ((resp==0) && (guardoBien)){
                        guardoBien=true;
                    }else{
                        guardoBien=false;
                    }
                }
            }
        }else{
            guardoBien=false;
        }
        if (guardoBien)
        {
            if(this.guardarMatriculadoTrabajo())
            {
                JOptionPane.showMessageDialog(null,"Registro almacenado correctamente", "Almacenamiento",JOptionPane.INFORMATION_MESSAGE);        
                
                this.bloquearPantalla();
            }
                
            else
                JOptionPane.showMessageDialog(null,"No se pudo almacenar correctament el registro", "Error en matriculado trabajo",JOptionPane.ERROR_MESSAGE);
        }else{
            JOptionPane.showMessageDialog(null,"No se pudo almacenar correctament el registro", "Error",JOptionPane.ERROR_MESSAGE);
        }
    }
    
    private boolean guardarMatriculadoTrabajo()
    {
        boolean bandera = true;
        CAlta alta = new CAlta();
        int respuesta;
        int idMatriculado;
        int tasa;
        for(int i=0;i<this.jTableParticipantes.getRowCount();i++)
                for(int k=0;k<this.tamanioVector;k++)
                    if(Boolean.parseBoolean(String.valueOf(this.jTableTrabajos.getValueAt(i, k))))
                    {
                        idMatriculado = Integer.parseInt(String.valueOf(this.jTableParticipantes.getValueAt(i, 0)));
                        tasa = this.vectorTrabajo[k].getIdTasaAplicable();
                        respuesta = alta.hacerAlta(this.jCSerie.getSelectedItem().toString().trim().toUpperCase(),this.nroConst,idMatriculado, tasa);
                        if(respuesta != 0)
                            bandera = false;
                    }
        return bandera;
    }
    
    private int guardarDetalleCP(int fil){
         //Asigna a la collection de Detalles los valores
        DetalleCP detalle=new DetalleCP();            
        //
        detalle.setSerieCP(this.jCSerie.getSelectedItem().toString().trim());
        CUltimo cod=new CUltimo();        
        detalle.setIddetalleCP(cod.getUltimo(detalle));//obtengo elultimo iddetalle
        detalle.setCodigoCP(this.nroConst);
        //
        detalle.setTipoTrabajo(this.getTrabajo(String.valueOf(this.jTableDetalle.getValueAt(fil, 0)).trim()));
        detalle.setTipoSuperficie(this.getSuperficie(String.valueOf(this.jTableDetalle.getValueAt(fil, 1)).trim()));
        detalle.setTipoSeccion(this.getSeccion(String.valueOf(this.jTableDetalle.getValueAt(fil, 2)).trim()));
        //detalle.setSuperficie(Double.parseDouble(String.valueOf(this.jTableDetalle.getValueAt(fil, 3))));
        detalle.setSuperficie(this.calcularSuperficie(fil));
        
        CAlta alta=new CAlta();        
        int respuesta = alta.hacerAltaDetalleCP(detalle);
        
        return respuesta;
        
   }
    
    private void nuevaConstancia()
    {
        this.jTFecha.setEnabled(true);
        this.jCSerie.setEnabled(true);
        this.jTNumeroConstancia.setEnabled(true);
        this.jTNombrePropietario.setEnabled(true);
        this.jTNombreComitente.setEnabled(true);
        this.jTMatricula.setEnabled(true);
        this.jTableDetalle.setEnabled(true);
        this.jTableParticipantes.setEnabled(true);
        this.jTableTrabajos.setEnabled(true);
        this.jTCalle.setEnabled(true);
        this.jTNumero.setEnabled(true);
        this.jTManzana.setEnabled(true);
        this.jTLote.setEnabled(true);
        this.jTOrdenTrabajo.setEnabled(true);
        this.jBGuardar.setEnabled(true);
        this.jBSalir.setEnabled(true);
        this.jBImprimir.setEnabled(false);
        this.jBNueva.setEnabled(false);
        this.jBUbicacion.setEnabled(true);        
        this.jTNumeroFactura.setText("");
        this.jTSerieFactura.setText("");
//        this.jBAgregarMatriculado.setEnabled(true);
        this.jBQuitarMatriculado.setEnabled(true);
        this.jBQuitarDetalle.setEnabled(true);
        //anulo el matriculado solicitante,sera otro nuevo
        this.matriculado=null;
        this.solicitanteCargado=false;
        
        this.cargarNroConstancia();
        this.cargarFecha();
        this.limpiarTablaMatriculados();
        this.limpiarUbicacion();
        this.quitarLineaDetalle();
        this.limpiarSuperficieYTotal();
        this.quitarDetalles();
        this.limpiarComitente();
    }
    
    private boolean esAutomatico()
    {
        boolean bandera = true;
        String serie = this.jCSerie.getSelectedItem().toString().trim().toUpperCase();
        Iterator it = this.series.iterator();
        while(it.hasNext())
        {
            SerieConstancia s = (SerieConstancia)it.next();
            if (s.getTipoConstancia().trim().equals("P"))//Solo carga las series de CONST PARCIALES
                if(s.getSerie().trim().equals(serie.trim()))
                    if(s.getTipoDeCarga().trim().equals("M"))
                        bandera = false;
            s = null;
        }
        return bandera;
    }
    
    private boolean controlarNumeroRepetido()
    {
        boolean bandera = true;
        Consulta con = new Consulta();        
        bandera = con.verificarNroConstancia(this.jTNumeroConstancia.getText().trim(), this.jCSerie.getSelectedItem().toString().trim().toUpperCase());
        con = null;
        return bandera;
    }
    
    private void bloquearPantalla()
    {
        this.jTFecha.setEnabled(false);
        this.jCSerie.setEnabled(false);
        this.jTNumeroConstancia.setEnabled(false);
        this.jTNombrePropietario.setEnabled(false);
        this.jTNombreComitente.setEnabled(false);
        this.jTMatricula.setEnabled(false);
        this.jTableDetalle.setEnabled(false);
        this.jTableParticipantes.setEnabled(false);
        this.jTableTrabajos.setEnabled(false);
        this.jTCalle.setEnabled(false);
        this.jTNumero.setEnabled(false);
        this.jTManzana.setEnabled(false);
        this.jTLote.setEnabled(false);
        this.jTOrdenTrabajo.setEnabled(false);
        this.jBGuardar.setEnabled(false);
        this.jBImprimir.setEnabled(true);
        this.jBNueva.setEnabled(true);
        this.jBImprimir.setEnabled(true);
        this.jBSalir.setEnabled(true);
//        this.jBAgregarMatriculado.setEnabled(false);
        this.jBUbicacion.setEnabled(false);
        this.jBQuitarMatriculado.setEnabled(false);
        this.jBQuitarDetalle.setEnabled(false);
        this.jTNumeroFactura.setEnabled(false);
        this.jTSerieFactura.setEnabled(false);
    }
    
    private void imprimir()
    {
        
        cExport_thread imprimeCP=new cExport_thread(34,this.jCSerie.getSelectedItem().toString().trim(),this.jTNumeroConstancia.getText().trim());
        imprimeCP.start();
    }
    
}
